<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Random Movie Generator</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container">
    <h1>Random Movie Generator</h1>
    <button onclick="getRandomMovie()">Obtenir un film au hasard</button>
    <div id="movieDetails">
      <h2 id="movieTitle"></h2>
      <p id="movieOverview"></p>
      <p id="releaseDate"></p>
      <div id="movieImage"></div>
    </div>
  </div>

  <script>
    const apiKey = '2c6cd4ceb33666821e89ac0236f6a6e3';
    let lastRequestTime = 0;

    async function getRandomMovie() {
      try {
        const now = Date.now();
        const timeSinceLastRequest = now - lastRequestTime;

        if (timeSinceLastRequest < 1000 / 35) {
          // Si moins d'une seconde s'est écoulée depuis la dernière requête, attendez le temps nécessaire
          const delay = 1000 / 35 - timeSinceLastRequest;
          await new Promise(resolve => setTimeout(resolve, delay));
        }

        lastRequestTime = Date.now();

        let page = Math.floor(Math.random() * 500) + 1;
        const response = await fetch(`https://api.themoviedb.org/3/discover/movie?api_key=${apiKey}&language=fr-FR&page=${page}`);
        const data = await response.json();

        const randomIndex = Math.floor(Math.random() * data.results.length);
        const randomMovie = data.results[randomIndex];

        const movieTitle = document.getElementById('movieTitle');
        const movieOverview = document.getElementById('movieOverview');
        const releaseDate = document.getElementById('releaseDate');
        const movieImage = document.getElementById('movieImage');

        movieTitle.textContent = randomMovie.title;
        movieOverview.textContent = randomMovie.overview;
        releaseDate.textContent = `Date de sortie : ${randomMovie.release_date}`;

        movieImage.style.backgroundImage = `url(https://image.tmdb.org/t/p/w500${randomMovie.poster_path})`;
      } catch (error) {
        console.error('Erreur lors de la récupération des données du film', error);
      }
    }
  </script>
</body>
</html>
